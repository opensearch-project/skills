{
  "CLAUDE": "\n\nHuman:Generate the monitor definition for an alert as the following json format without any other information.\nThe value of `${field_name}` should be a property in the mapping info and `${field_type} should be its type`\nYou could recommend some recommended fields or values for the definition if user does not provide them.\nNo need explanation in the response, it's very important that don't miss ```json.\n\nHuman:RESPONSE FORMAT INSTRUCTIONS\n----------------------------\n```json\n{\n    \"name\": \"\" //monitor name\n    \"search\": {\n        \"indices\": ${parameters.indices} //no need to change.\n        \"timeField\": \"${field_name}\", //this field should be date type\n        \"bucketValue\": 1, //A numeric value defining the time range for the last, default is 1.\n        \"bucketUnitOfTime\": \"m\",  //The time unit for the bucketValue, options include 'm' (minutes), 'h' (hours), or 'd' (days), with a default of 'h'\n        \"filters\": [ // A list of filters to filter logs to meet user's alert definition.\n            {\n                \"fieldName\": [ //The length should be 1.\n                    {\n                      \"label\": \"${field_name}\",\n                      \"type\": \"${field_type}\" //options are 'number', 'text', 'keyword', 'boolean'\n                    }\n                ],\n                \"fieldValue\": 10,\n                \"operator\": \"is\" //options are 'is', 'is_not', 'contains', 'does_not_contains', 'starts_with', 'ends_with', 'is_greater', 'is_greater_equal, 'is_less', 'is_less_equal.\n            },\n        ],\n        \"aggregations\": [\n            {\n                \"aggregationType\": \"count\", //options are ‘count’, ‘max’, ‘min’, ‘avg’, or ‘sum’, with a default of ‘count’.\n                \"fieldName\": \"${field_name}\"\n            }\n        ]\n    },\n    \"triggers\": [{  // The triggers for the alert, it triggers when the above aggregation result satisfies the threshold.\n        \"name\": 'Trigger' //The name of the trigger. You could generate this name based on this trigger definition.\n        \"severity\": 1, //The severity level of the trigger, options are 1, 2 and 3.\n        \"thresholdValue\": 0, //A numeric value defining the threshold.\n        \"thresholdEnum\": \"ABOVE\" //options are 'ABOVE', 'BELOW', or 'EXACTLY'.\n    }],\n}\n```\nHuman: Examples\n--------------------\nquestion: create alert if the count of non 200 response happens over 30 times per hour.\nresponse: {\\n\"name\": \"Error Response Alert\",\\n\"search\": {\\n\"indices\": [\"opensearch_dashboards_sample_data_logs\"],\\n\"timeField\": \"timestamp\",\\n\"bucketValue\": 60,\\n\"bucketUnitOfTime\": \"m\",\\n\"filters\": [\\n{\\n\"fieldName\": [\\n{\\n\"label\": \"response\",\\n\"type\": \"text\"\\n}\\n],\\n\"fieldValue\": \"200\",\\n\"operator\": \"is_not\"\\n}\\n],\\n\"aggregations\": [\\n{\\n\"aggregationType\": \"count\",\\n\"fieldName\": \"bytes\"\\n}\\n]\\n},\\n\"triggers\": [{\\n\"name\": \"Error Response Count Above 30\", \\n\"value\": 30,\\n\"enum\": \"ABOVE\"\\n}]\\n}\nHuman:USER'S CONTEXT\n--------------------\nmapping_info of the target index: ${parameters.mapping_info}\nHuman:CHAT HISTORY\n--------------------\n${parameters.chat_history}\nHuman:USER'S INPUT\n--------------------\nHere is the user's input :\n${parameters.question}\n\nAssistant:",
  "OPENAI": "Generate the monitor definition for an alert as the following json format without any other information.\nThe value of `${field_name}` should be a property in the mapping info and `${field_type} should be its type`\nYou could recommend some recommended fields or values for the definition if user does not provide them.\nNo need explanation in the response, it's very important that don't miss ```json.\n\nHuman:RESPONSE FORMAT INSTRUCTIONS\n----------------------------\n```json\n{\n    \"name\": \"\" //monitor name\n    \"search\": {\n        \"indices\": ${parameters.indices} //no need to change.\n        \"timeField\": \"${field_name}\",\n        \"bucketValue\": 1, //A numeric value defining the time range for the last, default is 1.\n        \"bucketUnitOfTime\": \"m\",  //The time unit for the bucketValue, options include 'm' (minutes), 'h' (hours), or 'd' (days), with a default of 'h'\n        \"filters\": [ // A list of filters to filter logs to meet user's alert definition.\n            {\n                \"fieldName\": [ //The length should be 1.\n                    {\n                      \"label\": \"${field_name}\",\n                      \"type\": \"${field_type}\" //options are 'number', 'text', 'keyword', 'boolean'\n                    }\n                ],\n                \"fieldValue\": 10,\n                \"operator\": \"is\" //options are 'is', 'is_not', 'contains', 'does_not_contains', 'starts_with', 'ends_with', 'is_greater', 'is_greater_equal, 'is_less', 'is_less_equal.\n            },\n        ],\n        \"aggregations\": [\n            {\n                \"aggregationType\": \"count\", //options are ‘count’, ‘max’, ‘min’, ‘avg’, or ‘sum’, with a default of ‘count’.\n                \"fieldName\": \"${field_name}\"\n            }\n        ]\n    },\n    \"triggers\": [{  // The triggers for the alert, it triggers when the above aggregation result satisfies the threshold.\n        \"name\": 'Trigger' //The name of the trigger. You could generate this name based on this trigger definition.\n        \"severity\": 1, //The severity level of the trigger, options are 1, 2 and 3.\n        \"thresholdValue\": 0, //A numeric value defining the threshold.\n        \"thresholdEnum\": \"ABOVE\" //options are 'ABOVE', 'BELOW', or 'EXACTLY'.\n    }],\n}\n```\nHuman: Examples\n--------------------\nquestion: create alert if the count of non 200 response happens over 30 times per hour.\nresponse: {\\n\"name\": \"Error Response Alert\",\\n\"search\": {\\n\"indices\": [\"opensearch_dashboards_sample_data_logs\"],\\n\"timeField\": \"timestamp\",\\n\"bucketValue\": 60,\\n\"bucketUnitOfTime\": \"m\",\\n\"filters\": [\\n{\\n\"fieldName\": [\\n{\\n\"label\": \"response\",\\n\"type\": \"text\"\\n}\\n],\\n\"fieldValue\": \"200\",\\n\"operator\": \"is_not\"\\n}\\n],\\n\"aggregations\": [\\n{\\n\"aggregationType\": \"count\",\\n\"fieldName\": \"bytes\"\\n}\\n]\\n},\\n\"triggers\": [{\\n\"name\": \"Error Response Count Above 30\", \\n\"value\": 30,\\n\"enum\": \"ABOVE\"\\n}]\\n}\nHuman:USER'S CONTEXT\n--------------------\nmapping_info of the target index: ${parameters.mapping_info}\nHuman:CHAT HISTORY\n--------------------\n${parameters.chat_history}\nHuman:USER'S INPUT\n--------------------\nHere is the user's input :\n${parameters.question}"
}
